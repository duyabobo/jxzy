# JXZY AI应用服务 v0.2 (规划中)

基于Go-Zero微服务框架构建的完整AI agent平台，扩展为功能丰富的三层微服务架构。

## 📋 项目概述

JXZY v0.2将在v0.1版本基础上，扩展为完整的AI agent平台，支持RAG检索、Prompt工程和高级AI能力。

## ✨ 新增功能

### 🆕 核心新特性
- 📚 **RAG检索**：文档向量化和智能检索服务
- 🎯 **高级上下文**：复杂会话管理和记忆能力
- 🔌 **Prompt工程**：支持blls_prompt工程，增强AI提示词管理能力
- 📖 **知识库管理**：完整的知识库和记忆模块管理服务
- 🌐 **完整架构**：扩展为完整的三层微服务架构
- 🧠 **AI Agent**：支持多步推理和工具调用
- 📊 **知识图谱**：构建领域知识关系网络

### 🔄 增强功能
- 💬 **多轮对话**：支持复杂的多轮对话场景
- 🎨 **多模态支持**：图像、音频、视频理解能力
- 🔗 **外部工具集成**：API调用、数据库查询、文件操作等
- 📈 **智能分析**：对话质量分析和优化建议

## 🏗️ 架构设计

### 完整三层微服务架构

v0.2版本将扩展为完整的AI服务架构，支持RAG检索和Prompt工程：

```
┌──────────────────────────────────────────────────────────────────┐
│                        Gateway Layer                             │
│                     (APIs - Port 8888)                           │
└──────────────────────────┬───────────────────────────────────────┘
                           │
                           ▼
┌────────────────────────────────────────────────────────────────────┐
│                 Business Logic Layer (BLLs)                        │
├────────────────────────────────────────────────────────────────────┤
│  ┌──────────────────┐  ┌──────────────────┐  ┌───────────────────┐ │
│  │BllsKnowledge-RPC │  │ BllsContext-RPC  │  │  BllsPrompt-RPC   │ │
│  │   (Port 8006)    │  │   (Port 8001)    │  │   (Port 8005)     │ │
│  └────────┬─────────┘  └───────┬──────────┘  └─────────▲─────────┘ │
│           │                   ││                       │           │
│           │                   │└──────────→────────────┘           │
└───────────┼───────────────────┼────────────────────────────────────┘
            │                   │
            │                   | 
            │                   |
            │                   │
            ▼                   ▼
┌──────────────────────────────────────────────────────────────────┐
│                  Basic Service Layer (BS)                        │
├──────────────────────────────────────────────────────────────────┤
│   ┌─────────────────┐              ┌─────────────────┐           │
│   │   BsLlm-RPC     │              │   BsRAG-RPC     │           │
│   │  (Port 8003)    │              │  (Port 8004)    │           │
│   └─────────────────┘              └─────────────────┘           │
└──────────────────────────────────────────────────────────────────┘
```

**调用关系**: 
- Gateway → BllsContext-RPC → {BsLlm-RPC, BsRAG-RPC, BllsPrompt-RPC}
- Gateway → BllsKnowledge-RPC → BsRAG-RPC
- BllsContext-RPC → BllsPrompt-RPC (业务编排：上下文服务调用提示词服务)

### 服务详情

#### Business Logic Layer (BLLs)
- **BllsContext-RPC (Port 8001)**
  - **服务定位**: 上下文工程的核心RPC服务
  - **核心功能**: 
    - 会话上下文管理和持久化
    - 对话历史记录存储和检索
    - 业务逻辑调度和流程控制
    - LLM模型选择策略和场景路由
    - 用户会话状态管理
  - **数据边界**: 负责所有与会话上下文相关的数据操作和业务逻辑

- **BllsKnowledge-RPC (Port 8006)**
  - **服务定位**: 知识库和记忆模块管理的核心RPC服务
  - **核心功能**:
    - 知识文件管理（上传、存储、版本控制）
    - 语义段管理和组织
    - 知识库的创建、更新和删除
    - 知识文件的元数据管理（文件名、类型、MD5等）
    - 知识库的访问控制和权限管理
    - 知识库的向量化和索引管理
    - 记忆模块的持久化和检索
    - 知识库的搜索和查询接口
  - **底层依赖**: 调用 BsRAG-RPC 进行向量化操作和向量检索
  - **数据边界**: 负责知识库相关的业务逻辑、元数据管理和与BsRAG-RPC的协调

- **BllsPrompt-RPC (Port 8005)**
  - **服务定位**: Prompt工程的核心RPC服务
  - **架构定位说明**: Prompt服务位于BLL层而非BS层，因为：
    - 涉及业务规则决策（A/B测试、效果评估、策略管理）
    - 需要业务上下文（场景、用户、历史数据）
    - 进行业务编排（动态生成、多场景路由）
    - 业务逻辑处理（合规性检查、安全性验证）
  - **核心功能**:
    - 提示词模板管理和版本控制
    - 动态提示词生成和优化（基于业务上下文）
    - 提示词效果评估和A/B测试
    - 多场景提示词策略管理（业务规则决策）
    - 提示词安全性和合规性检查（业务规则验证）
  - **数据边界**: 专注于提示词工程相关的业务逻辑和数据管理
  - **调用关系**: 被 BllsContext-RPC 调用，不直接调用 BS 层服务

#### Basic Service Layer (BS)
- **BsLlm-RPC (Port 8003)**
  - **服务定位**: 大语言模型服务的基础RPC
  - **核心功能**:
    - 大语言模型接口封装和抽象
    - 多供应商模型统一接入
    - 流式响应处理和优化
    - 模型配置管理和动态切换
    - Token使用统计和成本控制
  - **数据边界**: 专注于LLM调用，不涉及业务上下文管理

- **BsRAG-RPC (Port 8004)**
  - **服务定位**: 检索增强生成服务的基础RPC
  - **核心功能**:
    - 文档向量化和存储
    - 相似度检索和排序
    - 知识库管理和维护
    - 检索结果优化和重排序
    - 向量数据库连接管理
  - **数据边界**: 专注于文档检索和向量化，不涉及业务逻辑处理

## 🎯 技术特点

### 知识库管理系统
- **知识文件管理**: 支持文件上传、存储到OSS，元数据记录到MySQL
- **语义段管理**: 将知识文件切分为语义段，支持细粒度的知识检索
- **版本控制**: 支持知识文件的版本管理和历史追踪
- **元数据管理**: 完整记录文件信息（名称、大小、类型、MD5等）
- **向量化集成**: 与BsRAG-RPC集成，实现知识的向量化和检索
- **记忆模块**: 支持长期记忆和短期记忆的管理

### RAG检索系统
- **向量数据库**: Milvus/Qdrant支持
- **文档解析**: 多格式文档支持
- **智能分块**: 语义感知的文档分割
- **混合检索**: 关键词+向量双重检索

### Prompt工程系统
- **模板管理**: 可视化提示词模板编辑
- **动态生成**: 基于上下文的提示词动态生成
- **效果评估**: 提示词效果量化评估
- **版本控制**: 提示词版本管理和回滚

### AI Agent能力
- **任务规划**: 复杂任务自动分解
- **工具选择**: 智能工具选择策略
- **结果整合**: 多源信息融合
- **反思优化**: 结果评估和改进

## 📊 预期指标

### 性能目标
- **并发能力**: 10万+ QPS
- **响应延迟**: P99 < 500ms
- **检索精度**: Recall@10 > 90%
- **系统可用性**: 99.9%+

### 功能目标
- **支持文档格式**: 20+ 种
- **提示词模板**: 1000+ 个
- **多轮对话轮次**: 50+ 轮
- **知识库容量**: TB级

## 🔗 相关文档

- [v0.1版本文档](../v0.1/README.md)
- [项目总览](../../README.md)
- [技术规范](./tech-specs.md)
- [API设计](./api-design.md)
