syntax = "proto3";

package bll_knowledge;

option go_package = "./bll_knowledge";

// ====== 知识库管理相关消息定义 ======

// 知识添加类型
enum KnowledgeSourceType {
  SOURCE_TYPE_FILE_URL = 0;           // 通过OSS地址添加
  SOURCE_TYPE_SEGMENTS = 1;           // 直接传入segments片段列表
  SOURCE_TYPE_SUMMARIES = 2;          // 直接传入摘要句列表
}

message AddVectorKnowledgeRequest {
  KnowledgeSourceType source_type = 1; // 知识来源类型
  string file_url = 2;                 // 知识文件的OSS地址（source_type为FILE_URL时使用）
  repeated string segments = 3;        // 语义段片段列表（source_type为SEGMENTS时使用）
  repeated string summaries = 4;        // 摘要句列表（source_type为SUMMARIES时使用）
  string user_id = 5;                  // 用户ID
}

message AddVectorKnowledgeResponse {
  string vector_id = 1;               // 向量ID（summary和content的MD5）
  bool success = 2;                   // 操作是否成功
  string message = 3;                 // 响应消息
}

message DeleteVectorKnowledgeRequest {
  string vector_id = 1;               // 向量ID
  string user_id = 2;                 // 用户ID
}

message DeleteVectorKnowledgeResponse {
  bool success = 1;                   // 操作是否成功
  string message = 2;                 // 响应消息
}

// ====== 服务定义 ======

// 知识库管理服务
service BllKnowledgeService {
  // 添加知识库到向量数据库
  rpc AddVectorKnowledge(AddVectorKnowledgeRequest) returns (AddVectorKnowledgeResponse);
  
  // 从向量数据库删除知识库
  rpc DeleteVectorKnowledge(DeleteVectorKnowledgeRequest) returns (DeleteVectorKnowledgeResponse);
}
